---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r Set Directory}
#setwd("Box/DEPENd/NeuroMAP/Recruitment/Participant Management/")
directory_onedriveH<-file.path("/Users/strength/OneDrive - The Pennsylvania State University/") #set personal directory
directory_onedriveW<-file.path("/Users/bbh5255/OneDrive - The Pennsylvania State University/") #set personal directory
directory_work<-file.path("/Users/bbh5255/Box/DEPENd/NeuroMAP/Recruitment/Participant Management/") #set directory
directory_home<-file.path("/Users/strength/Documents/DepenD Lab/NeuroMAP/NMAPReports/") #set directory
```

```{r Cleaning Acuity Scheduling Data, include=FALSE}
SCHEDULE <-read_csv(paste0(directory_home, "Acuity Session Reports/all participant_acuity_feb20th.csv")) #read in acuity schedule info

#convert date time to readable format in R
SCHEDULE$`Start Time (AM/PM)`<-format(strptime(SCHEDULE$`Start Time`, format= '%m/%d/%y %H:%M'), "'%m/%d/%y '%I:%M:%S %p'") #convert time to am/pm from 24 hour clock
SCHEDULE$`Start Time`<-lubridate::mdy_hm(SCHEDULE$`Start Time`) #convert time to R friendly format
SCHEDULE$`Session Date`<- date(SCHEDULE$`Start Time`) # create date only variable for searching purposes

SCHEDULE$Type


SCHEDULE<-SCHEDULE %>%
  mutate(`Type (Recode)`=case_when(
    .$`Type` == "Session 1" ~ "Session 1",
    .$`Type` == "Session 1 Follow Up (1.5 hours)" ~ "Session 1 FU",
    .$`Type` == "Session 1 Follow Up (30 minutes)" ~ "Session 1 FU",
    .$`Type` == "Session 1 Follow Up (3 hours)" ~ "Session 1 FU",
    .$`Type` == "Session 2 (Marissa)" ~ "Session 2",
    .$`Type` == "Session 2 (Mia)" ~ "Session 2",
    .$`Type` == "Session 2 (Austin)" ~ "Session 2",
    .$`Type` == "Session 2 (Daniel and Begonia)" ~ "Session 2",
    .$`Type` == "Session 3 (1 hour follow-up)" ~ "Session 3 FU",
    .$`Type` == "Session 3 Follow-Up  (1.5 Hours)" ~"Session 3 FU",
    .$`Type` == "Session 3" ~ "Session 3"
    ))

```

Total Number of Hours of Scheduled Appointments on Acuity
```{r}
SCHEDULE %>% 
  select(
    `First Name`, 
    `Last Name`, 
    `Start Time`, 
    `Type (Recode)`, 
    `Type`,  
    `Calendar`) %>%
  dplyr::filter(`Start Time` >= END_WEEK) %>%
  group_by(`Type`) %>%
  tally() %>%
  mutate(number_hours = case_when(
    Type == "Session 1" ~ n * 3,
    Type == "Session 1 Follow Up (1.5 hours)" ~ n * 1.5,
    Type == "Session 1 Follow Up (3 hours)" ~ n * 3,
    Type == "Session 2 (Marissa)" ~ n * 2,
    #.$`Type (Recode) == "Session 2" ~ n[4] * 2,
    Type == "Session 2 (Mia)" ~ n *2,
    Type == "Session 3" ~ n *3)) %>%
  add_tally(number_hours)
```

```{r Number of Canceled Sessions}

SCHEDULE %>% 
  select(
    `First Name`, 
    `Last Name`, 
    `Start Time`, 
    `Type`,  
    `Calendar`,
    `Canceled`) %>%
  #dplyr::filter(`Start Time` >= END_WEEK) %>%
  group_by(Canceled) %>%
  tally()
  #mutate(Canceled = case_when(
    #Canceled == "canceled" ~ 1,
    #Canceled == "no-show" ~ 2))

```

```{r}
#number of scheduled/or assigned FMRI group members 
number_s4 <-17
hours_s4  <-2.15

#number of hours needed for s4 for all current fmri participants 
scheduled_s4=number_s4 * hours_s4

#enrollment goals for fmri
TotalEnrollY1<-13*3
TotalEnrollMarMay <-3*2

#number of total FMRI enrollees needed by May 1st
TotalMay<-TotalEnrollY1+TotalEnrollMarMay

#actual FMRI enrolles today
FmriToday<-7+14+8

#number of FMRI participants to enroll
EnrollmentNeededFmri<-TotalMay-FmriToday

#number of hours for expected s4

HoursExpectedS4 <- EnrollmentNeededFmri * hours_s4

```

Total number of hours needed for existing scheduled 1s and 3s (minus RA hours) + number of hours needed for session 3 + hours of s4 scheduled + hours of needed s4

```{r}

total_need <- (169.5-6) + (31*3) + scheduled_s4 + HoursExpectedS4


```

8(hours) * 5(days) = 40 hours - 5.5 hr(meetings) = 34.5 hours

34.5 hours * 10 weeks left in the semester (exlcuding break)

345 hours of work per lab member


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

